<%
# BigBlueButton open source conferencing system - http://www.bigbluebutton.org/.
# Copyright (c) 2018 BigBlueButton Inc. and by respective authors (see below).
# This program is free software; you can redistribute it and/or modify it under the
# terms of the GNU Lesser General Public License as published by the Free Software
# Foundation; either version 3.0 of the License, or (at your option) any later
# version.
#
# BigBlueButton is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
# You should have received a copy of the GNU Lesser General Public License along
# with BigBlueButton; if not, see <http://www.gnu.org/licenses/>.
%>
<style>

@import url("https://use.typekit.net/hvq7huk.css");

.card, .card2 {
  width: 350px;
  box-shadow: none;
  background-color: #fff;
  -webkit-font-smoothing: antialiased;
  transition: 0.3s ease-out all;
}
.card:hover, .card2:hover {
  -webkit-box-shadow: -1px -1px 16px -4px rgba(0, 0, 0, 0.44);
  -moz-box-shadow: -1px -1px 16px -4px rgba(0, 0, 0, 0.44);
  box-shadow: -1px -1px 16px -4px rgba(0, 0, 0, 0.44);
  transition: 0.3s ease-out all;
}

.card {
  transition: 0.3s ease-out all;
    background: #2E2F37;
    padding: 30px 20px;
    border-radius: 25px;
    box-shadow: 4px 6px 17px 1px #2e2f386b;
    max-width: 100%;
}

.card2 {
  opacity: 0.8;
  transition: 0.3s ease-out all;
}

.image {
  display: flex;
  width: 100%;
  background-size: cover;
  background-position-y: center;
  height: 180px;
  border-radius: 25px;
}
.image .alert {
  align-self: end;
  margin: 10px;
  background-color: #8bc34a;
  color: white;
  padding: 6px 8px;
  font-size: 10px;
  border-radius: 10px;
  text-transform: uppercase;
}

.des {
  padding: 12px;
  text-align: left;
}
.des .subtitle {
    color: white;
    text-align: left !important;
    text-shadow: 0px 2px 9px #1f202724;
    font-family: 'Roboto', sans-serif;
    font-weight: 300;
    font-size: 1.3rem;
}
h5 {
    color: #8387a5;
    text-align: left;
}
.des h1 {
  margin: 5px 0;
}
.des h1 span {
  font-weight: normal;
  margin-left: 10px;
  color: SeaGreen;
}
.des p {
  line-height: 22px;
}

hr {
  border: 1px solid Gainsboro;
  opacity: 0.3;
}

.adding, .ordered {
  display: inline-block;
  width: 100%;
  padding: 12px 0 12px 12px;
  text-align: left;
  text-transform: uppercase;
  font-weight: bold;
  font-size: 12px;
}

.adding {
  background-color: white;
  color: grey;
}
.adding:hover {
  background-color: LavenderBlush;
  color: black;
  cursor: pointer;
}

.ordered {
  background-color: PaleVioletRed;
  color: white;
  cursor: pointer;
}
.livedivide {
    padding-top: 30px;
}
.livenow {
    color: #fff;
    text-align: left;
}

div.radi-2 .card {
    border-top-left-radius: 0px !important;
    border-bottom-left-radius: 0px !important;
}
div.radi-1 .card {
    border-top-left-radius: 25px;
    border-bottom-left-radius: 25px !important;
    background: #202226;
    height: 97.6%;
}
a.appcues-button-success.appcues-button {
    padding: 10px 20px !important;
    background-color: rgb(71, 207, 115);
    color: rgb(8, 8, 8) !important;
    font-weight: 800;
}

section .canvas {
    background: #fff;
    padding-bottom: 90px;
    border-bottom-left-radius: 25px;
    border-bottom-right-radius: 25px;
    padding-top: 30px;
    padding-left: 0.6rem;
    padding-right: 0.6rem;
}

div.zone h2 {
    color: #000;
    font-weight: 700;
}


cue section {
    border-top: 9px solid #47cf73;
}
h3.title-yellow{
  color: #ffdd40;
}
.menuitemp {
    color: #fff;
    text-align: left;
    font-size: 1.2rem;
}
.container-fluid.dk {
    background: #000;
    padding-top: 10em;
    padding-bottom: 15em;
}
.whiteboxtxt{
  color: #fff;
  font-size: 5rem;
  width: 70%;
  margin: auto;
  margin-bottom: 25vh;
}
.logoblox img {
  margin: 9rem 2rem 0px;
}
p.introcopy {
    color: #838080;
    margin-top: 3rem;
    margin-bottom: -2rem;
}
video.upto4 {
    margin-left: -17vw;
    width: 130%;
}
video.upto4breakout{
  margin-right: -17vw;
  width: 130%;
  margin-left: 5vw
}

h3.subhead {
    color: white;
    font-size: 4rem;
}

p.subbody {
    color: #fff;
    font-size: 1.7rem;
}
ul.itemsfeat i {
    color: #0057ff;
    font-size: 2.5rem;
    display: block;
    margin-bottom: 1rem;
}
ul.itemsfeat li {
    color: #fff;
    font-size: 1.2rem;
    display: block;
}
ul.itemsfeat {
 padding: 0;
    list-style-type: none;
}

ul.itemsfeat li {list-style-position: inside;margin-bottom: 3rem;}

.itemsfeat b {
     display: block;
     font-size: 1.5rem;
    font-weight: 900;
}
span.shake {
    font-size: 4rem;
}
.mt-55x {
    margin-top: 13vh;
}
.card.cardcase {
  background: #fff;
  box-shadow: 1px 3px 15px 4px #46cf737d;
  width: 100%;
}

div.cardcase h5 {
    color: #000;
    font-size: 2rem;
    font-weight: 900;
}

div.cardcase p {
    font-size: 1.3rem;
}
.background{
  background: #0f0f0f;
}
ul#pills-tab {
    padding-top: 3rem;
    padding-bottom: 2.8rem;
}

ul.nav-pills li a.nav-link {
    color: #a8b2bc !important;
    font-size: 2rem;
}

ul.nav-pills li a.nav-link.active {
    color: #363f47 !important;
    background: transparent;
}

ul.nav-pills li {
    margin: auto;
}

ul.nav-pills {
    max-width: 30%;
    margin: auto;
}
.radi-1 .card {
    border-top-right-radius: 0px !important;
    border-bottom-right-radius: 0px;
    background: #0f0f0f;
}
.card {
  background: #0f0f0f;
  box-shadow: none;
}
div.radi-2 .card {
    width: 100%;
}
.image{
  height: 250px;
}
div.radi-1 .card {
    background: #0f0f0f;
}
.livenow {
    color: #686565;
}
.btn-primary{
  border: none;
}
h1#user-text {
    color: #fff;
}
a {
    color: #9d2bf6 !important;
}
label.form-label {
    color: #999697;
    text-align: left;
    font-size: 1.3rem;
}

input#invite-url {
    background: #000;
    font-size: 1.2rem;
    height: 45px;
}

div#room-title {
    max-height: 160px;
}
a#copy {
  background: linear-gradient(140.88deg,#0057ff 1.17%,#8127fd 88.49%);
  height: 96%;
  font-size: 1rem;
}

i.fas {
  background: transparent !important;
  padding-right: 5px;
}

i.fas:hover {
  background: transparent;
}
.force-bottom {
    margin-bottom: 210px;
}
.pushdown {
    padding-top: 105px;
}
button.btn.btn-primary.btn-block.px-7.start-button.float-right {
    background: linear-gradient(140.88deg,#0057ff 1.17%,#8127fd 88.49%) !important;
}
button.payblock {
    width: auto !important;
    height: auto !important;
    font-weight: 900;
}
</style>











<% exceeds_limit = current_room_exceeds_limit(@room)%>
<% if exceeds_limit%>
  <div class="alert alert-danger alert-dismissible text-center mb-0">
    <%= t("room.room_limit_exceeded", difference: @diff) %>
  </div>
<% end %>
<div class="background pb-1">
  <div class="container mt-0 mb-6 text-center">






  <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Discover</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-me" data-toggle="pill" href="#me" role="tab" aria-controls="me" aria-selected="false">Me</a>
  </li>
</ul>
<div class="tab-content" id="pills-tabContent">
  <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
  
 
  <!-- top panel -->
  <div class="row">
    
    
    
  <div class="col-2 radi-1 pl-0 ">
    <div class="card">

    <h3 class="livenow title-yellow">
    Explore
    </h3>
    <p class="menuitemp">Picks</p>
    <p class="menuitemp">Popular</p>
    <p class="menuitemp">Topics</p>

    </div>
  </div>







  <div class="col-5  radi-2">

     



    <div id="card" class="card pl-0">

   
   
   <h3 class="livenow">
   Trending Live Now
   </h3>
   
    
          <% current_user.all_rooms.each do |room| %>
              <% if room.name == 'Master' %>

              <% else %>
               <% if room.sessions > 0 %>
                <div class="livedivide">
                 
                    <%= link_to room do %>
                      <%= render "rooms/components/room_block", room: room %>
                    <% end %>
                  
                  </div>
                    <% end %>
                <% end %>
            <% end %>



  </div>

  </div>
<!--// trending -->




<div class="col-5 pl-0 radi-2">
    <div id="card" class="card pr-0">

   
   
   <h3 class="livenow">
   Upcoming
   </h3>
   
       <% current_user.all_rooms.each do |room| %>
              <% if room.name == 'Master' %>

              <% else %>
                <% if room.sessions == 0 %>
                <div class="livedivide">
                
                    <%= link_to room do %>
                      <%= render "rooms/components/room_block", room: room %>
                    <% end %>
                   
                  </div>
                   <% end %>
                <% end %>
            <% end %>



  </div>

  </div>
  <!-- //upcoming -->





</div>

  <!-- // top panel -->



  
  </div>
  <!-- // home -->


  <div class="tab-pane fade" id="me" role="tabpanel" aria-labelledby="pills-me">
  
  <div class="row">


  <div class="col-7">

    <div id="room-title" class="display-3 form-inline <%= 'edit_hover_class' if current_user.main_room != @room %>" data-path="<%= update_settings_path(@room) %>">
      <% if current_user.main_room == @room %>
       
      <% else %>
      

    

        <h1 contenteditable=false id="user-text" class="display-3 text-left mb-3 font-weight-400"><%= @room.name %></h1>
        <a><i id="edit-room" class="fa fa-edit align-top home-indicator ml-0" data-edit-room="<%= @room.uid %>"></i></a>
      <% end %>
    </div>
    <!--
    <h4 class="text-left mb-6"><%= @room.sessions %> <%= t("room.sessions") %> | <%= @recordings.length %> <%= t("room.recordings") %></h4>
    -->

    <% unless exceeds_limit %>
    <% if current_user.main_room == @room %>  

    <% else %>
    <label class="form-label"><%= t("room.invite_participants") %></label>
      <div class="row">
        <div class="col-lg-7 col-md-12 mt-2">
          <div class="input-icon invite-link-input">
            <span class="input-icon-addon">
              <i class="fas fa-link"></i>
            </span>
            <input id="invite-url" type="text" class="form-control w-100" value="<%= request.base_url + @room.invite_path %>" readonly="">
          </div>
        </div>
        <div class="col-lg-5 col-md-12">
          <div class="row">
            <div class="col-sm-6">
              <a id="copy" class="btn btn-primary btn-block mt-2">
                <i class="fas fa-copy"></i>
                <%= t("copy") %>
              </a>
            </div>
            <div class="col-sm-6 pl-0">
              <% if Rails.configuration.enable_google_calendar_button %>
                <a href="<%= google_calendar_path %>" target="__blank" id="schedule" class="btn btn-primary btn-block mt-2">
                  <i class="fas fa-calendar-plus"></i>
                  <%= t("add_to_google_calendar") %>
                </a>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <% end %>
    <% end %>
  </div>
  <% if current_user.main_room == @room %>
  <% else %>
  <div class="offset-lg-2 col-lg-3 col-sm-12 force-bottom mt-5">
    <% if @room_running %>
      <%= button_to t("room.join"), room_path(@room), class: "btn btn-primary btn-block px-7 start-button float-right", "data-disable": "" %>
    <% else %>
      <% unless exceeds_limit %>
        <button onClick="app.golive()" class="btn btn-primary btn-block px-7 start-button float-right">Start Live</button>
        <%= button_to t("room.start"), start_room_path(@room), class: "btn btn-primary btn-block px-7 start-button float-right hidden golivenow", "data-disable": "" %>
      <% end %>
    <% end %>
  </div>
  <% end %>
</div>









    <div class="row">



  
          <div class="col-6  radi-2">
          <div id="card" class="card pl-0">

        
        
              <h3 class="livenow">
             My Events
              </h3>
              

              <% current_user.ordered_rooms.each do |room| %>
                <% if current_user.main_room == room %>  
            
                <% else %>
                <div class="livedivide">
                  <%= link_to room do %>
                    <%= render "rooms/components/room_block", room: room %>
                  <% end %>
                </div>
                <% end %>
              <% end %>
                    
              <% if shared_access_allowed %>
                <% current_user.shared_rooms.each do |room| %>
                  <div class="col-lg-4 col-md-6 col-sm-12">
                    <%= link_to room do %>
                      <%= render "rooms/components/shared_room_block", room: room %>
                    <% end %>
                  </div>
                <% end %>
              <% end %>



             </div>


        </div>
      



        <div class="col-6  pushdown">
  <cue class="active appcues-actions-hidden">
      <section>
          <div class="canvas">
              <div class="row-container">
                  <div class="row" style="display: inline-block; width: 100%;">
                      <div class="zone-container" style="display: inline-block; width: 100%; float: left;">
                          <div class="zone">
                              <div class="zone-content">
                                  <div class="rich-text" style="margin-top: 20px;">
                                      <style>
                                          .rich-text strong {
                                              color: inherit !important;
                                          }
                                      </style>
                                      <div>
                                          <h2 style="text-align: center;">Want to create your own event?</h2>
                                          <p>
                                          It's easy. Doesn't take much.
                                          </p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="row-container">
                  <div class="row" style="display: inline-block; width: 100%;">
                      <div class="zone-container" style="display: inline-block; width: 100%; float: left;">
                          <div class="zone">
                              <div class="zone-content">
                                  <div class="button-wrapper appcues-actions-right" style="width: 100%; text-align: center; margin-top: 5px; margin-bottom: 5px;">
                                      <a class="appcues-button-success appcues-button" 
                                      data-toggle="modal" data-target="#createRoomModal"
                                          style="text-align: center; padding: 8px 18px; background-color: rgb(71, 207, 115); color: rgb(8, 8, 8); text-decoration: none;">Create an Event</a>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </section>
      <div class="appcues-actions hidden"></div>
  </cue>
  </div><!-- //col -->

            
  </div>

  </div><!-- // row -->

  </div>
  <!-- //profile me -->
</div>



  





   
<div class="hidden">
<%= render "shared/sessions", recordings: @recordings, pagy: @pagy, only_public: false, shared_room: @shared_room, user_recordings: false, title: t("room.recordings")%>
</div>

<%= render "shared/modals/delete_room_modal" %>

<%= render "shared/modals/create_room_modal" %>

<% if shared_access_allowed %>
  <%= render "shared/modals/share_room_modal" %>
  <%= render "shared/modals/remove_access_modal" %>
<% end %>

<script>
function dopay(){
var stripe = Stripe('pk_test_KLt0DZtasa7LviYi4dTCstWD');
stripe.redirectToCheckout({
  // Make the id field from the Checkout Session creation API response
  // available to this file, so you can provide it as parameter here
  // instead of the {{CHECKOUT_SESSION_ID}} placeholder.
  sessionId: '{{CHECKOUT_SESSION_ID}}'
}).then(function (result) {
  // If `redirectToCheckout` fails due to a browser or network
  // error, display the localized error message to your customer
  // using `result.error.message`.
});
            }
</script>



<script>
$(document).ready(() => {

setTimeout(()=>{


 


  let url = location.href.replace(/\/$/, "");
 
  if (location.hash) {
    const hash = url.split("#");
    $('#pills-tab a[href="#'+hash[1]+'"]').tab("show");
    url = location.href.replace(/\/#/, "#");
    history.replaceState(null, null, url);
    setTimeout(() => {
      $(window).scrollTop(0);
    }, 400);
  } 
   
  $('a[data-toggle="tab"]').on("click", function() {
    let newUrl;
    const hash = $(this).attr("href");
    if(hash == "#home") {
      newUrl = url.split("#")[0];
    } else {
      newUrl = url.split("#")[0] + hash;
    }
    newUrl += "/";
    history.replaceState(null, null, newUrl);
  });


  $('.livedivide a').each((d,e)=>{
    let p =  $(e).attr('href')
    console.log(    p.indexOf('/b')    )
    if ( p.indexOf('/b') > -1 ) $(e).attr('href', $(e).attr('href') + "#me")
    })

  },10)

});
</script>